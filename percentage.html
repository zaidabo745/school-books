<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø¦ÙˆÙŠØ© - Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªÙˆØ²ÙŠØ¹ Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ©</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <!-- Ø§Ù„Ø±Ø£Ø³ÙŠØ© -->
    <div class="header-section">
        <h1 class="main-title">Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªÙˆØ²ÙŠØ¹ Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ©</h1>
        <p class="subtitle">Ù†Ø¸Ø§Ù… Ø´Ø§Ù…Ù„ Ù„Ø­Ø³Ø§Ø¨ ÙˆØªÙˆØ²ÙŠØ¹ Ø§Ù„ÙƒØªØ¨ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³</p>
        <p class="footer-text">ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ÙˆØªØ·ÙˆÙŠØ± Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªØ­Øª Ø¥Ø´Ø±Ø§Ù Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ±Ø¨ÙŠØ© ÙˆØ§Ù„ØªØ¹Ù„ÙŠÙ… Ø¨Ø¬Ø¹Ù„Ø§Ù† 2025Ù…</p>
    </div>

    <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ -->
    <div class="nav-buttons">
        <a href="index.html" class="nav-btn">
            <span class="icon">ğŸ“š</span>
            Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙˆØ²ÙŠØ¹
        </a>
        <a href="percentage.html" class="nav-btn">
            <span class="icon">ğŸ“Š</span>
            Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø¦ÙˆÙŠØ©
        </a>
    </div>

    <!-- Ù…Ø­ØªÙˆÙ‰ ØµÙØ­Ø© Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø¦ÙˆÙŠØ© -->
    <div class="schools-container">
        <h2 style="text-align: center; color: #2980b9;">Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø¦ÙˆÙŠØ© Ù„Ù„ØªÙˆØ²ÙŠØ¹</h2>
        
        <div class="school-section">
            <h3>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙˆØ²ÙŠØ¹</h3>
            <div class="school-inputs">
                <div class="input-group">
                    <label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨:</label>
                    <input type="number" id="totalStudents" placeholder="Ø£Ø¯Ø®Ù„ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨" min="1">
                </div>
                <div class="input-group">
                    <label>Ø¹Ø¯Ø¯ Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…ÙˆØ²Ø¹Ø©:</label>
                    <input type="number" id="distributedBooks" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ø¯Ø¯ Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…ÙˆØ²Ø¹Ø©" min="0">
                </div>
                <div class="input-group">
                    <label>Ø¹Ø¯Ø¯ Ø§Ù„ÙƒØ±Ø§ØªÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©:</label>
                    <input type="number" id="usedBoxes" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ø¯Ø¯ Ø§Ù„ÙƒØ±Ø§ØªÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©" min="0">
                </div>
                <div class="input-group">
                    <label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒØ±Ø§ØªÙŠÙ† Ø§Ù„Ù…ØªØ§Ø­Ø©:</label>
                    <input type="number" id="totalBoxes" placeholder="Ø£Ø¯Ø®Ù„ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒØ±Ø§ØªÙŠÙ† Ø§Ù„Ù…ØªØ§Ø­Ø©" min="1">
                </div>
            </div>
        </div>

        <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª -->
        <div class="action-buttons">
            <button onclick="calculatePercentages()" class="btn-primary">
                <span>ğŸ“Š</span>
                Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø¦ÙˆÙŠØ©
            </button>
            <button onclick="exportPercentagesToExcel()" class="btn-warning">
                <span>ğŸ“¤</span>
                ØªØµØ¯ÙŠØ± Ø§Ù„Ù†Ø³Ø¨ Ø¥Ù„Ù‰ Excel
            </button>
            <button onclick="clearPercentages()" class="btn-danger">
                <span>ğŸ—‘ï¸</span>
                Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            </button>
        </div>

        <!-- Ø¹Ø±Ø¶ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø¦ÙˆÙŠØ© -->
        <div id="percentageResults" class="results" style="display: none;">
            <h3>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø¦ÙˆÙŠØ©</h3>
            <div id="percentageContent"></div>
        </div>
    </div>

    <script>
        let percentageData = {};

        function calculatePercentages() {
            const totalStudents = parseInt(document.getElementById('totalStudents').value) || 0;
            const distributedBooks = parseInt(document.getElementById('distributedBooks').value) || 0;
            const usedBoxes = parseInt(document.getElementById('usedBoxes').value) || 0;
            const totalBoxes = parseInt(document.getElementById('totalBoxes').value) || 0;

            if (totalStudents === 0 || totalBoxes === 0) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©');
                return;
            }

            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø¦ÙˆÙŠØ©
            const distributionPercentage = ((distributedBooks / totalStudents) * 100).toFixed(2);
            const boxUsagePercentage = ((usedBoxes / totalBoxes) * 100).toFixed(2);
            const remainingBooks = totalStudents - distributedBooks;
            const remainingBoxes = totalBoxes - usedBoxes;
            const remainingPercentage = ((remainingBooks / totalStudents) * 100).toFixed(2);

            percentageData = {
                totalStudents,
                distributedBooks,
                usedBoxes,
                totalBoxes,
                distributionPercentage,
                boxUsagePercentage,
                remainingBooks,
                remainingBoxes,
                remainingPercentage
            };

            displayPercentageResults();
        }

        function displayPercentageResults() {
            const resultsDiv = document.getElementById('percentageResults');
            const content = document.getElementById('percentageContent');

            const resultsHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div style="background: #e8f5e8; padding: 20px; border-radius: 10px; border-right: 4px solid #27ae60;">
                        <h4 style="color: #27ae60; font-size: 1.3rem; margin-bottom: 15px;">Ù†Ø³Ø¨Ø© Ø§Ù„ØªÙˆØ²ÙŠØ¹</h4>
                        <p><strong>Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…ÙˆØ²Ø¹Ø©:</strong> ${percentageData.distributedBooks} ÙƒØªØ§Ø¨</p>
                        <p><strong>Ù…Ù† Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</strong> ${percentageData.totalStudents} Ø·Ø§Ù„Ø¨</p>
                        <p style="font-size: 1.4rem; color: #27ae60;"><strong>Ø§Ù„Ù†Ø³Ø¨Ø©: ${percentageData.distributionPercentage}%</strong></p>
                    </div>

                    <div style="background: #e3f2fd; padding: 20px; border-radius: 10px; border-right: 4px solid #2196f3;">
                        <h4 style="color: #2196f3; font-size: 1.3rem; margin-bottom: 15px;">Ù†Ø³Ø¨Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒØ±Ø§ØªÙŠÙ†</h4>
                        <p><strong>Ø§Ù„ÙƒØ±Ø§ØªÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©:</strong> ${percentageData.usedBoxes} ÙƒØ±ØªÙˆÙ†</p>
                        <p><strong>Ù…Ù† Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</strong> ${percentageData.totalBoxes} ÙƒØ±ØªÙˆÙ†</p>
                        <p style="font-size: 1.4rem; color: #2196f3;"><strong>Ø§Ù„Ù†Ø³Ø¨Ø©: ${percentageData.boxUsagePercentage}%</strong></p>
                    </div>

                    <div style="background: #fff3e0; padding: 20px; border-radius: 10px; border-right: 4px solid #ff9800;">
                        <h4 style="color: #ff9800; font-size: 1.3rem; margin-bottom: 15px;">Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©</h4>
                        <p><strong>Ø¹Ø¯Ø¯ Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©:</strong> ${percentageData.remainingBooks} ÙƒØªØ§Ø¨</p>
                        <p><strong>Ø§Ù„ÙƒØ±Ø§ØªÙŠÙ† Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©:</strong> ${percentageData.remainingBoxes} ÙƒØ±ØªÙˆÙ†</p>
                        <p style="font-size: 1.4rem; color: #ff9800;"><strong>Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: ${percentageData.remainingPercentage}%</strong></p>
                    </div>
                </div>

                <div style="background: #3498db; color: white; padding: 20px; margin: 20px 0; border-radius: 10px; text-align: center;">
                    <h4 style="font-size: 1.4rem; margin-bottom: 15px;">Ù…Ù„Ø®Øµ Ø§Ù„ØªÙˆØ²ÙŠØ¹</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div>
                            <p style="font-size: 1.1rem; margin: 5px 0;"><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø§Ø¨:</strong></p>
                            <p style="font-size: 1.3rem; font-weight: bold;">${percentageData.totalStudents}</p>
                        </div>
                        <div>
                            <p style="font-size: 1.1rem; margin: 5px 0;"><strong>Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…ÙˆØ²Ø¹Ø©:</strong></p>
                            <p style="font-size: 1.3rem; font-weight: bold;">${percentageData.distributedBooks}</p>
                        </div>
                        <div>
                            <p style="font-size: 1.1rem; margin: 5px 0;"><strong>Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²:</strong></p>
                            <p style="font-size: 1.3rem; font-weight: bold;">${percentageData.distributionPercentage}%</p>
                        </div>
                    </div>
                </div>
            `;

            content.innerHTML = resultsHTML;
            resultsDiv.style.display = 'block';
        }

        function exportPercentagesToExcel() {
            if (!percentageData.totalStudents) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±. ÙŠØ±Ø¬Ù‰ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø¦ÙˆÙŠØ© Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }

            const excelData = [
                { 'Ø§Ù„Ø¨ÙŠØ§Ù†': 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨', 'Ø§Ù„Ù‚ÙŠÙ…Ø©': percentageData.totalStudents, 'Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©': '100%' },
                { 'Ø§Ù„Ø¨ÙŠØ§Ù†': 'Ø¹Ø¯Ø¯ Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…ÙˆØ²Ø¹Ø©', 'Ø§Ù„Ù‚ÙŠÙ…Ø©': percentageData.distributedBooks, 'Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©': percentageData.distributionPercentage + '%' },
                { 'Ø§Ù„Ø¨ÙŠØ§Ù†': 'Ø¹Ø¯Ø¯ Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©', 'Ø§Ù„Ù‚ÙŠÙ…Ø©': percentageData.remainingBooks, 'Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©': percentageData.remainingPercentage + '%' },
                { 'Ø§Ù„Ø¨ÙŠØ§Ù†': 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒØ±Ø§ØªÙŠÙ† Ø§Ù„Ù…ØªØ§Ø­Ø©', 'Ø§Ù„Ù‚ÙŠÙ…Ø©': percentageData.totalBoxes, 'Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©': '100%' },
                { 'Ø§Ù„Ø¨ÙŠØ§Ù†': 'Ø§Ù„ÙƒØ±Ø§ØªÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©', 'Ø§Ù„Ù‚ÙŠÙ…Ø©': percentageData.usedBoxes, 'Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©': percentageData.boxUsagePercentage + '%' },
                { 'Ø§Ù„Ø¨ÙŠØ§Ù†': 'Ø§Ù„ÙƒØ±Ø§ØªÙŠÙ† Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©', 'Ø§Ù„Ù‚ÙŠÙ…Ø©': percentageData.remainingBoxes, 'Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©': (100 - parseFloat(percentageData.boxUsagePercentage)).toFixed(2) + '%' }
            ];

            const worksheet = XLSX.utils.json_to_sheet(excelData);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø¦ÙˆÙŠØ©");

            worksheet['!cols'] = [{ width: 25 }, { width: 15 }, { width: 20 }];

            const currentDate = new Date().toLocaleDateString('ar-SA');
            XLSX.writeFile(workbook, `Ø§Ù„Ù†Ø³Ø¨_Ø§Ù„Ù…Ø¦ÙˆÙŠØ©_${currentDate}.xlsx`);
        }

        function clearPercentages() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ')) {
                document.getElementById('totalStudents').value = '';
                document.getElementById('distributedBooks').value = '';
                document.getElementById('usedBoxes').value = '';
                document.getElementById('totalBoxes').value = '';
                document.getElementById('percentageResults').style.display = 'none';
                percentageData = {};
            }
        }
    </script>
</body>
</html>